"use strict";var GameEngineComponent=(()=>{var Q=Object.create;var v=Object.defineProperty;var X=Object.getOwnPropertyDescriptor;var Z=Object.getOwnPropertyNames;var ee=Object.getPrototypeOf,te=Object.prototype.hasOwnProperty;var re=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),oe=(t,e)=>{for(var r in e)v(t,r,{get:e[r],enumerable:!0})},P=(t,e,r,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Z(e))!te.call(t,n)&&n!==r&&v(t,n,{get:()=>e[n],enumerable:!(o=X(e,n))||o.enumerable});return t};var ne=(t,e,r)=>(r=t!=null?Q(ee(t)):{},P(e||!t||!t.__esModule?v(r,"default",{value:t,enumerable:!0}):r,t)),le=t=>P(v({},"__esModule",{value:!0}),t);var k=re((je,_)=>{"use strict";var B=Object.defineProperty,se=Object.getOwnPropertyDescriptor,ie=Object.getOwnPropertyNames,ae=Object.prototype.hasOwnProperty,ce=(t,e)=>{for(var r in e)B(t,r,{get:e[r],enumerable:!0})},ue=(t,e,r,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of ie(e))!ae.call(t,n)&&n!==r&&B(t,n,{get:()=>e[n],enumerable:!(o=se(e,n))||o.enumerable});return t},fe=t=>ue(B({},"__esModule",{value:!0}),t),E={};ce(E,{BotOutcome:()=>be,GameSpeed:()=>pe,createTemplate:()=>me,file:()=>S});_.exports=fe(E);var be={Victory:"victory",Defeat:"defeat",Draw:"draw",Error:"error",None:"none"},pe={Fast:"fast",Normal:"normal",Paused:"paused"};function w(t=644){return(e,...r)=>{let o="";e.forEach((i,a)=>{o+=i+(r[a]??"")});let n=o.split(`
`);for(;n[0]?.trim()==="";)n.shift();let l=n[0]?.match(/^\s+/)?.[0]??"";return{contents:n.map(i=>i.startsWith(l)?i.slice(l.length):i).join(`
`),mode:t}}}var S=w();S.mode=t=>w(t);S.executable=w(755);function me(t){return t}});var Ne={};oe(Ne,{play:()=>Be});var u=ne(k());var G=(t=0)=>e=>`\x1B[${e+t}m`,I=(t=0)=>e=>`\x1B[${38+t};5;${e}m`,D=(t=0)=>(e,r,o)=>`\x1B[${38+t};2;${e};${r};${o}m`,s={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],gray:[90,39],grey:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgGray:[100,49],bgGrey:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}},$=Object.keys(s.modifier),M=Object.keys(s.color),N=Object.keys(s.bgColor),L=[...M,...N];function de(){let t=new Map;for(let[e,r]of Object.entries(s)){for(let[o,n]of Object.entries(r))s[o]={open:`\x1B[${n[0]}m`,close:`\x1B[${n[1]}m`},r[o]=s[o],t.set(n[0],n[1]);Object.defineProperty(s,e,{value:r,enumerable:!1})}return Object.defineProperty(s,"codes",{value:t,enumerable:!1}),s.color.close="\x1B[39m",s.bgColor.close="\x1B[49m",s.color.ansi=G(),s.color.ansi256=I(),s.color.ansi16m=D(),s.bgColor.ansi=G(10),s.bgColor.ansi256=I(10),s.bgColor.ansi16m=D(10),Object.defineProperties(s,{rgbToAnsi256:{value(e,r,o){return e===r&&r===o?e<8?16:e>248?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(r/255*5)+Math.round(o/255*5)},enumerable:!1},hexToRgb:{value(e){let r=/[a-f\d]{6}|[a-f\d]{3}/i.exec(e.toString(16));if(!r)return[0,0,0];let[o]=r;o.length===3&&(o=[...o].map(l=>l+l).join(""));let n=Number.parseInt(o,16);return[n>>16&255,n>>8&255,n&255]},enumerable:!1},hexToAnsi256:{value:e=>s.rgbToAnsi256(...s.hexToRgb(e)),enumerable:!1},ansi256ToAnsi:{value(e){if(e<8)return 30+e;if(e<16)return 90+(e-8);let r,o,n;if(e>=232)r=((e-232)*10+8)/255,o=r,n=r;else{e-=16;let a=e%36;r=Math.floor(e/36)/5,o=Math.floor(a/6)/5,n=a%6/5}let l=Math.max(r,o,n)*2;if(l===0)return 30;let i=30+(Math.round(n)<<2|Math.round(o)<<1|Math.round(r));return l===2&&(i+=60),i},enumerable:!1},rgbToAnsi:{value:(e,r,o)=>s.ansi256ToAnsi(s.rgbToAnsi256(e,r,o)),enumerable:!1},hexToAnsi:{value:e=>s.ansi256ToAnsi(s.hexToAnsi256(e)),enumerable:!1}}),s}var ge=de(),c=ge;var x=(()=>{if(navigator.userAgentData){let t=navigator.userAgentData.brands.find(({brand:e})=>e==="Chromium");if(t&&t.version>93)return 3}return/\b(Chrome|Chromium)\//.test(navigator.userAgent)?1:0})(),W=x!==0&&{level:x,hasBasic:!0,has256:x>=2,has16m:x>=3},he={stdout:W,stderr:W},V=he;function Y(t,e,r){let o=t.indexOf(e);if(o===-1)return t;let n=e.length,l=0,i="";do i+=t.slice(l,o)+e+r,l=o+n,o=t.indexOf(e,l);while(o!==-1);return i+=t.slice(l),i}function U(t,e,r,o){let n=0,l="";do{let i=t[o-1]==="\r";l+=t.slice(n,i?o-1:o)+e+(i?`\r
`:`
`)+r,n=o+1,o=t.indexOf(`
`,n)}while(o!==-1);return l+=t.slice(n),l}var{stdout:K,stderr:J}=V,T=Symbol("GENERATOR"),p=Symbol("STYLER"),h=Symbol("IS_EMPTY"),q=["ansi","ansi","ansi256","ansi16m"],m=Object.create(null),ye=(t,e={})=>{if(e.level&&!(Number.isInteger(e.level)&&e.level>=0&&e.level<=3))throw new Error("The `level` option should be an integer from 0 to 3");let r=K?K.level:0;t.level=e.level===void 0?r:e.level};var ve=t=>{let e=(...r)=>r.join(" ");return ye(e,t),Object.setPrototypeOf(e,y.prototype),e};function y(t){return ve(t)}Object.setPrototypeOf(y.prototype,Function.prototype);for(let[t,e]of Object.entries(c))m[t]={get(){let r=O(this,R(e.open,e.close,this[p]),this[h]);return Object.defineProperty(this,t,{value:r}),r}};m.visible={get(){let t=O(this,this[p],!0);return Object.defineProperty(this,"visible",{value:t}),t}};var j=(t,e,r,...o)=>t==="rgb"?e==="ansi16m"?c[r].ansi16m(...o):e==="ansi256"?c[r].ansi256(c.rgbToAnsi256(...o)):c[r].ansi(c.rgbToAnsi(...o)):t==="hex"?j("rgb",e,r,...c.hexToRgb(...o)):c[r][t](...o),xe=["rgb","hex","ansi256"];for(let t of xe){m[t]={get(){let{level:r}=this;return function(...o){let n=R(j(t,q[r],"color",...o),c.color.close,this[p]);return O(this,n,this[h])}}};let e="bg"+t[0].toUpperCase()+t.slice(1);m[e]={get(){let{level:r}=this;return function(...o){let n=R(j(t,q[r],"bgColor",...o),c.bgColor.close,this[p]);return O(this,n,this[h])}}}}var Oe=Object.defineProperties(()=>{},{...m,level:{enumerable:!0,get(){return this[T].level},set(t){this[T].level=t}}}),R=(t,e,r)=>{let o,n;return r===void 0?(o=t,n=e):(o=r.openAll+t,n=e+r.closeAll),{open:t,close:e,openAll:o,closeAll:n,parent:r}},O=(t,e,r)=>{let o=(...n)=>Ae(o,n.length===1?""+n[0]:n.join(" "));return Object.setPrototypeOf(o,Oe),o[T]=t,o[p]=e,o[h]=r,o},Ae=(t,e)=>{if(t.level<=0||!e)return t[h]?"":e;let r=t[p];if(r===void 0)return e;let{openAll:o,closeAll:n}=r;if(e.includes("\x1B"))for(;r!==void 0;)e=Y(e,r.close,r.open),r=r.parent;let l=e.indexOf(`
`);return l!==-1&&(e=U(e,n,o,l)),o+e+n};Object.defineProperties(y.prototype,m);var Ce=y(),Ge=y({level:J?J.level:0});var A=Ce;async function*Be(t){let e=t.config.initialTurn,r={board:t.config.initialBoard};for(;;){let o=Me(r)?.outcome??null;if(o!==null)return o;let n=e%2===0?0:1,l=t.bots[n],i=Se(r);l.writeln(A.dim("Start turn"));let a=await l.move(i).then(we);l.writeln(A.dim(`\u2937 x=${a.x} y=${a.y}`));let d=r.board[a.x][a.y];if(typeof d=="number")return r.board[a.x][a.y]=[d,e],l.writeln(A.red(`
Spot { x: ${a.x}, y: ${a.y} } already occupied.`)),yield r,[n===0?u.BotOutcome.Error:u.BotOutcome.None,n===1?u.BotOutcome.Error:u.BotOutcome.None];r.board[a.x][a.y]=e,yield r,e++}}function we(t){let[e,r]=t.split(",").map(o=>{if(/(0|1|2)/.test(o))return parseInt(o)});if(e===void 0||r===void 0)throw new Error(`Response invalid: "${t}"`);return{x:e,y:r}}function Se(t){return t.board.map(r=>r.map(o=>o===null?"empty":(Array.isArray(o)?o[0]%2===0:o%2===0)?"x":"o")).map(r=>r.join(",")).join("|")}function Me(t){let e={x:0,y:0},r={x:0,y:1},o={x:0,y:2},n={x:1,y:0},l={x:1,y:1},i={x:1,y:2},a={x:2,y:0},d={x:2,y:1},C={x:2,y:2},z=[[e,r,o],[n,l,i],[a,d,C],[e,n,a],[r,l,d],[o,i,C],[e,l,C],[a,l,o]];for(let f of[0,1]){let b=z.find(H=>H.every(F=>{let g=t.board[F.x]?.[F.y];return g===null?!1:(Array.isArray(g)&&(g=g[0]??0),g%2===f)}));if(b)return{winningLine:b,outcome:[f===0?u.BotOutcome.Victory:u.BotOutcome.Defeat,f===1?u.BotOutcome.Victory:u.BotOutcome.Defeat]}}for(let f=0;f<3;f++)for(let b=0;b<3;b++)if(t.board[f][b]===null)return null;return{outcome:[u.BotOutcome.Draw,u.BotOutcome.Draw]}}return le(Ne);})();
